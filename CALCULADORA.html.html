<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Calculadora de Tasas Tiendanube</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f2f5; /* Fondo más claro */
            padding: 20px;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
        }
        .calculator {
            background: white;
            max-width: 450px;
            width: 100%;
            margin: 20px auto;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border: 1px solid #e0e0e0;
        }
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        .header h1 {
            color: #007bff; /* Azul de Tiendanube */
            font-size: 32px;
            margin-bottom: 5px;
        }
        .header h2 {
            color: #555;
            font-size: 20px;
            margin-top: 0;
        }
        .input-group {
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
            font-size: 15px;
        }
        input[type="number"] {
            width: calc(100% - 20px);
            padding: 15px 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 24px;
            text-align: center;
            color: #000;
            font-weight: bold;
            outline: none;
            transition: border-color 0.3s ease;
        }
        input[type="number"]:focus {
            border-color: #1a73e8;
        }
        .price-input-wrapper {
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }

        select {
            width: 100%;
            padding: 12px 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
            color: #555;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23000%22%20d%3D%22M287%2C114.7L159.9%2C241.8c-2.4%2C2.4-5.5%2C3.6-8.7%2C3.6s-6.3-1.2-8.7-3.6L5.4%2C114.7c-4.8-4.8-4.8-12.5%2C0-17.3l2.4-2.4c4.8-4.8%2C12.5-4.8%2C17.3%2C0l133.4%2C133.3L267.3%2C95c4.8-4.8%2C12.5-4.8%2C17.3%2C0l2.4%2C2.4C291.8%2C102.2%2C291.8%2C109.9%2C287%2C114.7z%22%2F%3E%3C%2Fsvg%3E');
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 12px;
            cursor: pointer;
            transition: border-color 0.3s ease;
        }
        select:focus {
            border-color: #1a73e8;
        }

        button {
            background-color: #1a73e8;
            color: white;
            padding: 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
            transition: background-color 0.3s ease;
        }
        button:hover {
            background-color: #0d47a1;
        }
        .result {
            margin-top: 30px;
            font-weight: bold;
            text-align: center;
            color: #000;
            line-height: 1.8;
            font-size: 17px;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        .disclaimer {
            font-size: 12px; /* Tamaño de fuente más pequeño para el disclaimer */
            color: #777; /* Color gris suave */
            margin-top: 15px; /* Margen superior para separarlo del resto del resultado */
            text-align: center;
        }
        .error {
            color: #d32f2f;
            font-weight: bold;
            font-size: 16px;
        }
    </style>
</head>
<body>
    <div class="calculator">
        <div class="header">
            <h1>Tiendanube</h1>
            <h2>Calculadora de Tasas</h2>
        </div>

        <div class="input-group">
            <label for="montoVenta">Monto de la venta</label>
            <div class="price-input-wrapper">
                <input type="number" id="montoVenta" placeholder="0,00" min="0" step="0.01" />
            </div>
        </div>

        <div class="input-group">
            <label for="formaPago">¿Qué forma de pago querés ofrecer?</label>
            <select id="formaPago"></select>
        </div>

        <button onclick="calcular()">Calcular tasas</button>

        <div class="result" id="resultado"></div>
    </div>

    <script>
        // Data de tasas y cuotas organizada para el selector combinado
        const formasDePagoOpciones = [
            // Cuota Simple
            { type: "cuotaSimple", cuotas: 2, label: "Cuota Simple - 2 cuotas", tasa: 3.68 },
            { type: "cuotaSimple", cuotas: 3, label: "Cuota Simple - 3 cuotas", tasa: 5.38 },
            { type: "cuotaSimple", cuotas: 6, label: "Cuota Simple - 6 cuotas", tasa: 10.26 },
            
            // Pago Nube (Cuotas sin interés)
            { type: "pagoNube", cuotas: 2, label: "Pago Nube - 2 cuotas sin interés", tasa: 9.50 },
            { type: "pagoNube", cuotas: 3, label: "Pago Nube - 3 cuotas sin interés", tasa: 12.75 },
            { type: "pagoNube", cuotas: 6, label: "Pago Nube - 6 cuotas sin interés", tasa: 21.75 },
            { type: "pagoNube", cuotas: 9, label: "Pago Nube - 9 cuotas sin interés", tasa: 29.75 },
            { type: "pagoNube", cuotas: 12, label: "Pago Nube - 12 cuotas sin interés", tasa: 36.40 },

            // Opción de Transferencia bancaria (si aplica)
            { type: "transferencia", cuotas: 1, label: "Transferencia bancaria", tasa: 0.00 } // Asumimos 0% de comisión
        ];

        const IVA_PERCENTAGE = 0.21; // 21% de IVA en Argentina

        const montoVentaInput = document.getElementById("montoVenta");
        const formaPagoSelect = document.getElementById("formaPago");
        const resultadoDiv = document.getElementById("resultado");

        // Función para poblar el selector de "Forma de pago"
        function inicializarFormasDePago() {
            formaPagoSelect.innerHTML = ""; // Limpiar opciones existentes

            // Agrega una opción por defecto "Seleccioná una opción"
            const defaultOption = document.createElement("option");
            defaultOption.value = "";
            defaultOption.text = "Seleccioná una forma de pago...";
            defaultOption.disabled = true; // No seleccionable
            defaultOption.selected = true; // Seleccionada por defecto
            formaPagoSelect.appendChild(defaultOption);
            
            // Recorre el array de opciones y crea un <option> para cada una
            formasDePagoOpciones.forEach((opcion, index) => {
                const optionElement = document.createElement("option");
                // El valor contendrá el índice para luego encontrar fácilmente los datos
                optionElement.value = index; 
                optionElement.text = opcion.label;
                formaPagoSelect.appendChild(optionElement);
            });
            
            // Si ya hay un monto y una forma de pago seleccionada al cargar, recalcular
            if (parseFloat(montoVentaInput.value) > 0 && formaPagoSelect.value !== "") {
                calcular();
            } else {
                 resultadoDiv.innerHTML = ''; // Limpia el resultado al inicio
                 resultadoDiv.classList.remove('error');
            }
        }

        // Función principal de cálculo
        function calcular() {
            const monto = parseFloat(montoVentaInput.value);
            const selectedIndex = parseInt(formaPagoSelect.value); // Obtiene el índice de la opción seleccionada

            resultadoDiv.classList.remove('error');
            resultadoDiv.innerHTML = '';

            // 1. Validar el monto
            if (isNaN(monto) || monto <= 0) {
                resultadoDiv.classList.add('error');
                resultadoDiv.innerHTML = "¡Atención! Ingresá un monto de venta válido (mayor a cero).";
                return;
            }

            // 2. Validar que se haya seleccionado una forma de pago
            if (isNaN(selectedIndex) || selectedIndex < 0 || selectedIndex >= formasDePagoOpciones.length) {
                resultadoDiv.classList.add('error');
                resultadoDiv.innerHTML = "¡Atención! Seleccioná una forma de pago válida.";
                return;
            }

            // 3. Obtener los datos de la opción seleccionada usando el índice
            const opcionSeleccionada = formasDePagoOpciones[selectedIndex];
            
            const tasaBase = opcionSeleccionada.tasa;
            const tasaConIVA = tasaBase * (1 + IVA_PERCENTAGE); // Comisión final con IVA

            // 4. Calcular el monto final
            const montoFinalConRecargo = monto * (1 + (tasaConIVA / 100));
            
            // 5. Obtener el número de cuotas directamente de la opción
            const numCuotas = opcionSeleccionada.cuotas;

            const valorCuota = montoFinalConRecargo / numCuotas; 

            // 6. Mostrar el resultado
            let resultHtml = `Detalle para ${opcionSeleccionada.label}:<br>` +
                             `Comisión efectiva con IVA: <strong>${tasaConIVA.toFixed(2)}%</strong><br>` +
                             `Total a pagar (con recargo): <strong>$${montoFinalConRecargo.toFixed(2)}</strong><br>`;
            
            if (numCuotas > 1) {
                resultHtml += `Valor de cada cuota: <strong>$${valorCuota.toFixed(2)}</strong>`;
            } else if (tasaBase > 0) { // Es 1 cuota pero con comisión
                 resultHtml += `(Pago en 1 cuota)`;
            } else if (tasaBase === 0) { // Es 1 cuota y sin comisión (ej: transferencia)
                resultHtml += `(Sin recargo adicional)`;
            }

            // Agregar el disclaimer al final del resultado
            resultHtml += `<div class="disclaimer">No incluye impuestos, percepciones y/o retenciones ajenas a Pago Nube.</div>`;

            resultadoDiv.innerHTML = resultHtml;
        }

        // --- Event Listeners y Inicialización ---
        montoVentaInput.addEventListener("input", calcular);
        formaPagoSelect.addEventListener("change", calcular);
        
        // Llama a la función de inicialización al cargar la página
        inicializarFormasDePago();
    </script>
</body>
</html>